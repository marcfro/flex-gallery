/*! FlexGallery v0.0.1 | https://github.com/marcfro/flex-gallery | Copyright 2013, Marco DiDomenico | http://kit.mit-license.org */
var FlexGallery,__bind=function(a,b){return function(){return a.apply(b,arguments)}};FlexGallery=(function(){function a(b){this.getShortestColumnKey=__bind(this.getShortestColumnKey,this);this.addFillers=__bind(this.addFillers,this);this.draw=__bind(this.draw,this);var d,c;this.parentWidth=0;this.outerGutter=0;this.columns=[];d={id:"flexGallery",gutter:20,columnWidth:260,fireOnComplete:"flex-gallery",addFillers:true};this.options=this.extend(d,b);$("#"+this.options.id).css({position:"relative",display:"block",margin:"0",padding:"0"});c=this;$(window).resize(function(){return c.draw()});$(window).on("load",function(){return c.draw(true)});this.draw()}a.prototype.draw=function(c){var g,j,f,e,k,d,l,h,b;if(c==null){c=false}l=c;d=$("#"+this.options.id).parent().width();if(this.parentWidth===0||d!==this.parentWidth||c){l=true;this.parentWidth=d;h=Math.floor(this.parentWidth/this.options.columnWidth);f=h-1;g=Math.floor((this.parentWidth-(f*this.options.gutter))/this.options.columnWidth);if(g<=0){g=1}this.outerGutter=Math.floor((this.parentWidth-((g*this.options.columnWidth)+(f*this.options.gutter)))/2);this.columns=(function(){var m,i;i=[];for(e=m=1;1<=g?m<=g:m>=g;e=1<=g?++m:--m){i.push(0)}return i})()}k=this;$("#"+this.options.id+" li").each(function(m,n){var i,o;if(l||typeof $(n).data("flex-gallery-set")==="undefined"){$(n).css({"max-width":k.options.columnWidth+"px",position:"absolute",left:"0",top:"0",display:"block",visibility:"hidden","min-width":k.options.columnWidth+"px"});i=$(n).height();o=k.getShortestColumnKey();$(n).css({top:k.columns[o]+"px",left:k.calculateLeftPosition(o)+"px",visibility:"visible"});k.columns[o]+=parseInt(i+k.options.gutter,10);return $(n).data("flex-gallery-set",1)}});j=this.columns.slice();j.sort(this.sorter);b=j[this.columns.length-1];$("#"+this.options.id).css({height:b+"px"});if(l&&this.options.addFillers){this.addFillers(b)}$("#"+this.options.id).trigger(this.options.fireOnComplete,null,{outerGutter:this.outerGutter});return $("#"+this.options.id)};a.prototype.addFillers=function(b){var c,e,d;$(".flex-gallery-filler").each(function(f,g){return g.remove()});d=this.columns;for(c in d){e=d[c];if(e<b){c=parseInt(c,10);$(document.createElement("div")).appendTo($("#"+this.options.id)).css({"max-width":this.options.columnWidth+"px",position:"absolute",display:"block","min-width":this.options.columnWidth+"px",height:(b-e-this.options.gutter)+"px",left:this.calculateLeftPosition(c)+"px",top:e+"px"}).addClass("flex-gallery-filler")}}};a.prototype.calculateLeftPosition=function(b){return(b*this.options.columnWidth)+(this.options.gutter*b)+this.outerGutter};a.prototype.getShortestColumnKey=function(){var f,c,d,b,g,e;b=0;f=this.columns.slice();f.sort(this.sorter);e=this.columns;for(d in e){g=e[d];if(g===0){return d}c=0;while(c<f.length){if(g===f[0]){return d}c++}}return b};a.prototype.sorter=function(d,c){return d-c};a.prototype.extend=function(b,d){var c,e;for(c in d){e=d[c];b[c]=e}return b};return a})();